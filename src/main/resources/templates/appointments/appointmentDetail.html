<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/layout :: layout (~{::body},'appointments','Appointment detail')}" xmlns:sec="http://www.w3.org/1999/xhtml">

<body>
<div class="row align-items-center justify-content-center"   style="margin-top: 50px">
    <div>
        <table id="appointments" class="table table-striped text-center" >
            <thead class="thead-dark">
            <tr>
                <th colspan="2"> Appointment details: </th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>Status </td>
                <td><span th:text="${appointment.status}"> scheduled </span></td>
            </tr>
            <tr>
                <td>Customer</td>
                <td><span th:text="${appointment.customer.firstName+' '+appointment.customer.userName}">Name Surname</span></td>
            </tr>
            <tr>
                <td>Provider</td>
                <td><span th:text="${appointment.provider.firstName+' '+appointment.provider.userName}">Name Surname</span></td>
            </tr>
            <tr>
                <td>Work </td>
                <td><span th:text="${appointment.work.name}"> english </span></td>
            </tr>
            <tr>
                <td>Cancellable </td>
                <td><span th:text="${appointment.work.editable}"> true </span></td>
            </tr>
            <tr>
                <td>Description </td>
                <td><span th:text="${appointment.work.description}">description</span></td>
            </tr>
            <tr>
                <td>Start date </td>
                <td><span th:text="${appointment.start}"> 10.01.2019 13:41:45 </span></td>
            </tr>
            <tr>
                <td>Duration </td>
                <td><span th:text="${appointment.work.duration}"> 30 </span> min</td>
            </tr>
            <tr>
                <td>Price </td>
                <td><span th:text="${appointment.work.price}"> 50 </span> pln</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div th:if="${allowCancel}">
    <form th:action="@{/appointments/cancel}" method='POST'>
        <input type="hidden" name="id" th:value="${appointment.id}">
        <input type="submit" class="btn btn-danger" value="Cancel"/>
    </form>
</div>
<div th:unless="${allowCancel && appointment.status == 'canceled'}">
    <div th:switch="${denyCancelReason}">
        <p th:case="'limitExceed'">You can't cancel this appointment because you exceeded maximum number of cancellations in this month.</p>
        <p th:case="'expired'">Appointments which will be in less than 24 hours cannot be canceled.</p>
        <p th:case="'type'">This type of appointment can be cancelled only by Provider.</p>
    </div>
</div>

<!--<div class="row align-items-center justify-content-center"   style="margin-top: 50px">
    <form th:action="@{/appointments/chatMessages/new}" th:object="${chatMessage}" method='POST'>
        <input type="hidden" name="appointmentId" th:value="${appointment.id}">
        <input type="text" th:field="*{subject}" placeholder="subject"><br>
        <textarea class="input-group" rows="3" th:field="*{message}" placeholder="message" /><br>
        <input type="submit" class="btn btn-primary" value="Add message"/>
    </form>
</div>-->

<div class="row">
    <div class="col-sm-3">

    </div>
    <div class="col-sm-6">
        <div class="chatbody">
            <div class="panel panel-primary">
                <div class="panel-heading top-bar">
                    <div class="col-md-8 col-xs-8">
                        <h3 class="panel-title">
                            Chat -
                            <span sec:authorize="hasRole('ROLE_PROVIDER')" th:text="${appointment.customer.userName}"></span>
                            <span sec:authorize="hasRole('ROLE_CUSTOMER')" th:text="${appointment.provider.userName}"></span>
                        </h3>
                    </div>
                </div>

                <div class="panel-body msg_container_base">
                    <div th:each="chatMessage : ${appointment.chatMessages}" class="row msg_container base_receive">
                        <div class="col-md-12 col-xs-12">
                            <div class="messages msg_receive">
                                <p th:text="${chatMessage.message}">messae</p>
                                <time datetime="2009-11-13T20:00"><span th:text="${chatMessage.author.firstName}">author</span> â€¢ <span th:text="${chatMessage.createdAt}"></span></time>
                            </div>
                        </div>
                    </div>
                </div>

                <form th:action="@{/appointments/messages/new}" th:object="${chatMessage}" method='POST'>
                <div class="input-group mb-3">
                        <input type="hidden" name="appointmentId" th:value="${appointment.id}">
                    <input type="text" class="form-control"  th:field="*{message}" placeholder="Write your message here..." aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="submit">Send</button>
                    </div>
                </div>
                </form>


               <!-- <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="button">Button</button>
                    </div>
                </div>-->

            </div>

        </div>
    </div>
    <div class="col-sm-3">

    </div>
</div>
</div>
</body>
</html>